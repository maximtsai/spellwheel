function showVictoryScreen(){globalObjects.player.getPlayerCastSpellsCount()}function swirlInReaperFog(e=1.66,a=0,t=-5){let l=getFogSwirlGlow(a),s=getFogSwirl(a);l.setDepth(t),s.setDepth(t),s.currAnimScale=PhaserScene.tweens.add({targets:[s,l],scaleX:e,scaleY:e,alpha:.5,ease:"Cubic.easeOut",duration:12e3}),s.currAnim=PhaserScene.tweens.add({targets:[s,l],rotation:"+=6.283",duration:67018,repeat:-1})}function clearDeathFog(){globalObjects.fogSwirl&&(globalObjects.fogSwirl.currAnim&&globalObjects.fogSwirl.currAnim.stop(),globalObjects.fogSwirl.currAnimScale&&globalObjects.fogSwirl.currAnimScale.stop(),PhaserScene.tweens.add({targets:[globalObjects.fogSwirl],scaleX:2.25,scaleY:2.25,alpha:0,ease:"Quad.easeIn",duration:550}),PhaserScene.tweens.add({targets:[globalObjects.fogSwirlGlow],scaleX:2,scaleY:2,alpha:0,ease:"Cubic.easeIn",duration:600}))}function getFogSlice(){return globalObjects.fogSlice||(globalObjects.fogSlice=PhaserScene.add.image(gameConsts.halfWidth+8,-44,"backgrounds","fog_slice.png").setDepth(-2).setOrigin(.68,.29)),globalObjects.fogSlice.setAlpha(.2).setScale(1.01).setRotation(-.8).setPosition(gameConsts.halfWidth+8,-45),globalObjects.fogSlice}function getFogSliceDarken(){return globalObjects.fogSliceDarken||(globalObjects.fogSliceDarken=PhaserScene.add.image(gameConsts.halfWidth,gameConsts.halfHeight,"blackPixel").setDepth(-3).setScale(500,500)),globalObjects.fogSliceDarken.setAlpha(1).setPosition(gameConsts.halfWidth,gameConsts.halfHeight),globalObjects.fogSliceDarken}function getFogSwirl(e){return globalObjects.fogSwirl||(globalObjects.fogSwirl=PhaserScene.add.image(gameConsts.halfWidth,240,"backgrounds","fog_swirl.png").setDepth(-3).setScale(2.2).setRotation(-1).setAlpha(0),globalObjects.fogSwirl.scrollFactorX=.25,globalObjects.fogSwirl.scrollFactorY=.25),0==globalObjects.fogSwirl.alpha&&globalObjects.fogSwirl.setScale(2.25).setRotation(-1),globalObjects.fogSwirl.setPosition(gameConsts.halfWidth,240+e),globalObjects.fogSwirl}function tweenObjectRotationTo(e,a,t=250,l,s){return PhaserScene.tweens.add({targets:e,rotation:a,duration:t,ease:l,onComplete:s})}function hideHandsTemp(){globalObjects.deathLeftHand.setOrigin(0,1e3),globalObjects.deathRightHand.setOrigin(0,1e3)}function showHandsTemp(){globalObjects.deathLeftHand.setOrigin(.5,.5),globalObjects.deathRightHand.setOrigin(.5,.5)}function getFloatingDeath(){return!globalObjects.floatingDeath&&(globalObjects.floatingDeath=PhaserScene.add.image(gameConsts.halfWidth,95,"enemies","max_death_1a.png").setDepth(-1),globalObjects.floatingDeath.setAlpha(.4),globalObjects.floatingDeath2=PhaserScene.add.image(gameConsts.halfWidth,95,"enemies","max_death_1b.png").setDepth(-1).setVisible(!1),leftHandOffsetY=26,rightHandOffsetY=-50,globalObjects.deathLeftHand=PhaserScene.add.image(gameConsts.halfWidth+-114,globalObjects.floatingDeath.y+leftHandOffsetY,"enemies","max_death_left_arm.png"),globalObjects.deathRightHand=PhaserScene.add.image(gameConsts.halfWidth+189,globalObjects.floatingDeath.y+rightHandOffsetY,"enemies","max_death_right_hand.png"),globalObjects.deathLeftHand.startY=globalObjects.deathLeftHand.y,globalObjects.deathRightHand.startY=globalObjects.deathRightHand.y,globalObjects.deathLeftHand.offsetX=-114,globalObjects.deathLeftHand.offsetY=leftHandOffsetY,globalObjects.deathRightHand.offsetX=189,globalObjects.deathRightHand.offsetY=rightHandOffsetY,setFloatingDeathScale(.32)),!1===globalObjects.floatingDeath.visible&&(globalObjects.floatingDeath.setVisible(!0).setAlpha(.05).setScale(.35).setDepth(-1),globalObjects.floatingDeath2.setVisible(!1),globalObjects.deathLeftHand.setAlpha(.05),globalObjects.deathRightHand.setAlpha(.05),setFloatingDeathScale(.32)),globalObjects.deathLeftHand.setDepth(globalObjects.floatingDeath.depth+1),globalObjects.deathRightHand.setDepth(globalObjects.floatingDeath.depth+1),tweenObjectRotationTo(globalObjects.deathLeftHand,-.35,10),tweenObjectRotationTo(globalObjects.deathRightHand,.3,10),globalObjects.deathLeftHand.fakeAlpha=0,globalObjects.deathRightHand.fakeAlpha=0,globalObjects.floatingDeath.fakeAlpha=globalObjects.floatingDeath.alpha,globalObjects.floatingDeath2.fakeAlpha=globalObjects.floatingDeath.alpha,globalObjects.floatingDeath}function getFogSwirlGlow(e){return globalObjects.fogSwirlGlow||(globalObjects.fogSwirlGlow=PhaserScene.add.image(gameConsts.halfWidth,225,"backgrounds","fog_swirl_glow.png").setDepth(-3).setAlpha(0),globalObjects.fogSwirlGlow.scrollFactorX=.25,globalObjects.fogSwirlGlow.scrollFactorY=.25),0==globalObjects.fogSwirlGlow.alpha&&globalObjects.fogSwirlGlow.setScale(2).setRotation(-1),globalObjects.fogSwirlGlow.setPosition(gameConsts.halfWidth,225+e),globalObjects.fogSwirlGlow}function setFloatingDeathScale(e){globalObjects.floatingDeath.setScale(e),globalObjects.floatingDeath2.setScale(e),globalObjects.deathLeftHand.setScale(e),globalObjects.deathLeftHand.setPosition(globalObjects.floatingDeath.x+globalObjects.deathLeftHand.offsetX*e,globalObjects.floatingDeath.y+globalObjects.deathLeftHand.offsetY*e),globalObjects.deathRightHand.setScale(e),globalObjects.deathRightHand.setPosition(globalObjects.floatingDeath.x+globalObjects.deathRightHand.offsetX*e,globalObjects.floatingDeath.y+globalObjects.deathRightHand.offsetY*e)}function stopFloatingDeathTween(){globalObjects.floatingDeath.currAnim1&&(globalObjects.floatingDeath.currAnim1.stop(),globalObjects.floatingDeath.currAnim2.stop(),globalObjects.floatingDeath.currAnim3.stop())}function tweenFloatingDeath(e=.75,a=1,t=1200,l="Cubic.easeInOut",s){stopFloatingDeathTween(),setFloatingDeathVisible(!0),globalObjects.floatingDeath.currAnim1=PhaserScene.tweens.add({targets:[globalObjects.floatingDeath,globalObjects.floatingDeath2,globalObjects.deathLeftHand,globalObjects.deathRightHand],scaleX:e,scaleY:e,ease:l,fakeAlpha:a<.15?a-.15:a,duration:t,onComplete:s}),globalObjects.floatingDeath.currAnim2=PhaserScene.tweens.add({targets:[globalObjects.deathLeftHand],x:globalObjects.floatingDeath.x+globalObjects.deathLeftHand.offsetX*e,y:globalObjects.floatingDeath.y+globalObjects.deathLeftHand.offsetY*e,ease:l,alpha:a,duration:t}),globalObjects.floatingDeath.currAnim3=PhaserScene.tweens.add({targets:[globalObjects.deathRightHand],x:globalObjects.floatingDeath.x+globalObjects.deathRightHand.offsetX*e,y:globalObjects.floatingDeath.y+globalObjects.deathRightHand.offsetY*e,ease:l,alpha:a,duration:t})}function setFloatingDeathDepth(e){globalObjects.floatingDeath.setDepth(e),globalObjects.floatingDeath2.setDepth(e),globalObjects.deathLeftHand.setDepth(e+1),globalObjects.deathRightHand.setDepth(e+1)}function repeatDeathHandsRotate(){globalObjects.deathLeftHand.currAnim=tweenObjectRotationTo(globalObjects.deathLeftHand,.03,2500,"Cubic.easeInOut"),globalObjects.deathRightHand.currAnim=tweenObjectRotationTo(globalObjects.deathRightHand,-.03,2500,"Cubic.easeInOut",()=>{globalObjects.deathLeftHand.currAnim=tweenObjectRotationTo(globalObjects.deathLeftHand,-.05,2500,"Cubic.easeInOut"),globalObjects.deathRightHand.currAnim=tweenObjectRotationTo(globalObjects.deathRightHand,.05,2500,"Cubic.easeInOut",()=>{repeatDeathHandsRotate()})})}function setFloatingDeathVisible(e,a=!1){globalObjects.floatingDeath.visible=e,globalObjects.floatingDeath2.visible=e,a?(globalObjects.deathLeftHand.visible=!1,globalObjects.deathRightHand.visible=!1):(globalObjects.deathLeftHand.visible=e,globalObjects.deathRightHand.visible=e)}function playReaperAnim(e,a,t=!0){let l=e.getLevel();if(t){playSound("whoosh").detune=-500,globalObjects.reaperDarkFlashTop||(globalObjects.reaperDarkFlashBot=PhaserScene.add.image(gameConsts.halfWidth,gameConsts.halfHeight,"blackPixel"),globalObjects.reaperDarkFlashTop=PhaserScene.add.image(-150,gameConsts.halfHeight,"pixels","black_blue_pixel.png").setOrigin(1,.5).setDepth(60),globalObjects.reaperDarkFlashTop2=PhaserScene.add.image(-150,gameConsts.halfHeight,"pixels","black_blue_pixel.png").setOrigin(1,.5).setDepth(60),globalObjects.reaperDarkFlashTop3=PhaserScene.add.image(-150,gameConsts.halfHeight,"pixels","black_blue_pixel.png").setOrigin(1,.5).setDepth(60)),globalObjects.reaperDarkFlashBot.setScale(700).setAlpha(0).setVisible(!0),globalObjects.reaperDarkFlashTop.setScale(500,750).setRotation(.38).setPosition(-160,gameConsts.halfHeight).setAlpha(.05).setVisible(!0),globalObjects.reaperDarkFlashTop2.setScale(50+80*Math.random(),700).setRotation(.3).setPosition(-140,gameConsts.halfHeight).setAlpha(.65).setVisible(!0),globalObjects.reaperDarkFlashTop3.setScale(500,750).setRotation(.26).setPosition(-120,gameConsts.halfHeight).setAlpha(.3).setVisible(!0);let s=Math.floor(50*Math.random());PhaserScene.tweens.add({targets:globalObjects.reaperDarkFlashTop,scaleY:750,duration:350+s,onComplete:()=>{setupReaperArrival(),tweenFloatingDeath(.75,1,1200,"Cubic.easeInOut",()=>{gameVars.deathFlutterDelay=450;let t=PhaserScene.add.sprite(gameConsts.halfWidth,140,"misc","scythe1.png").setDepth(999).setAlpha(0).setScale(.65).setRotation(-1.5);t.play("scytheFlash"),PhaserScene.tweens.add({targets:t,alpha:1,duration:450}),PhaserScene.tweens.add({targets:t,y:75,scaleX:.8,scaleY:.8,rotation:-1.35,ease:"Quart.easeIn",duration:400,onComplete:()=>{e.customBgMusic&&fadeAwaySound(e.customBgMusic,1e3,""),PhaserScene.time.delayedCall(820,()=>{tweenObjectRotationTo(globalObjects.deathLeftHand,-.2,500,"Cubic.easeOut"),tweenObjectRotationTo(globalObjects.deathRightHand,.1,500,"Cubic.easeOut")}),PhaserScene.tweens.add({targets:t,scaleX:.9,scaleY:.9,y:65,ease:"Cubic.easeInOut",duration:900}),PhaserScene.tweens.add({targets:t,rotation:-.5,ease:"Quart.easeOut",duration:900,completeDelay:200,onComplete:()=>{t.play("scytheReap"),PhaserScene.tweens.add({targets:t,rotation:"-=1.5",ease:"Quint.easeIn",duration:50,onComplete:()=>{e.customBgMusic&&e.customBgMusic.stop();let s=getFogSlice(),i=getFogSliceDarken();PhaserScene.tweens.add({targets:i,alpha:.75,ease:"Cubic.easeOut",duration:500});let n=globalObjects.fogSwirl?globalObjects.fogSwirl.alpha:1;if(PhaserScene.tweens.add({targets:globalObjects.fogSwirl,alpha:.25,ease:"Cubic.easeIn",duration:300,onComplete(){PhaserScene.tweens.add({delay:100,targets:globalObjects.fogSwirl,ease:"Cubic.easeInOut",alpha:n,duration:1e3})}}),PhaserScene.tweens.add({delay:50,targets:[s],alpha:1,ease:"Quad.easeOut",duration:200,onComplete(){PhaserScene.tweens.add({delay:200,targets:[s,i],ease:"Quart.easeIn",alpha:0,duration:1400})}}),PhaserScene.tweens.add({delay:50,targets:[s],scaleX:1.08,scaleY:1.08,ease:"Quint.easeOut",duration:300,onComplete(){PhaserScene.tweens.add({targets:[s],scaleX:1.1,scaleY:1.1,duration:1500})}}),PhaserScene.tweens.add({delay:50,targets:s,rotation:-.85,ease:"Quad.easeOut",duration:1500}),e){let o=e.sprite;PhaserScene.tweens.add({targets:o,scaleX:1.2*o.scaleX,scaleY:1.2*o.scaleX,alpha:0,duration:750})}setTimeout(()=>{playSound(globalObjects.reapSound||"death_attack").detune=0,messageBus.publish("reapedEnemyGong"),messageBus.publish("showCircleShadow",.4),globalObjects.reapSound=null,messageBus.publish("tempPause",70,.1)},100);let r=PhaserScene.add.image(gameConsts.halfWidth,gameConsts.halfHeight,"blackPixel").setScale(500).setDepth(980).setAlpha(1);this.scytheBlur||(this.scytheBlur=PhaserScene.add.image(gameConsts.halfWidth,t.y,"blurry","scytheblur.png").setDepth(1002).setBlendMode(Phaser.BlendModes.LIGHTEN)),this.scytheBlur.setAlpha(1).setScale(.82).setRotation(-.15),PhaserScene.tweens.add({targets:[r],alpha:0,duration:1500,ease:"Quad.easeOut",onComplete(){r.destroy()}}),PhaserScene.tweens.add({targets:[this.scytheBlur],alpha:0,ease:"Cubic.easeOut",duration:700}),PhaserScene.tweens.add({targets:t,rotation:-3.5,x:"-=10",ease:"Quint.easeOut",duration:500,onComplete(){repeatDeathHandsRotate(),PhaserScene.tweens.add({delay:200,targets:t,rotation:"+=0.1",x:"-=12",ease:"Quart.easeInOut",duration:2e3}),PhaserScene.tweens.add({targets:t,alpha:0,delay:1e3,scaleX:.6,scaleY:.6,ease:"Cubic.easeIn",duration:600,onComplete(){t.destroy(),e.destroy(),setFloatingDeathDepth(100010),handleReaperDialog(l,()=>{gameVars.deathFlutterDelay=10,repeatDeathFlutterAnimation(-.25),clearReaper(),globalObjects.postFightScreen.startGloom(),PhaserScene.tweens.add({targets:[t],scaleX:.5,scaleY:.5,alpha:0,ease:"Cubic.easeIn",duration:1100,completeDelay:200,onComplete(){PhaserScene.tweens.add({targets:[globalObjects.fogSliceDarken],alpha:0,duration:1e3,onComplete(){globalObjects.fogSliceDarken.destroy()}}),a?a():setTimeout(()=>{globalObjects.magicCircle.enableMovement(),globalObjects.postFightScreen.createWinScreen(l)},200)}})})}})}})}})}})}})}),globalObjects.reaperDarkFlashTop2.visible&&setFloatingDeathVisible(!1)}}),PhaserScene.tweens.add({targets:globalObjects.reaperDarkFlashTop3,duration:320+Math.floor(30*Math.random()),rotation:.12,ease:"Quad.easeIn",x:gameConsts.width+160,onComplete(){globalObjects.reaperDarkFlashTop3.visible=!1}}),PhaserScene.tweens.add({targets:globalObjects.reaperDarkFlashTop3,alpha:1,duration:450,ease:"Cubic.easeIn"}),PhaserScene.tweens.add({delay:10,targets:globalObjects.reaperDarkFlashTop2,alpha:1,duration:465+30*Math.random(),ease:"Quad.easeIn",rotation:.23,x:gameConsts.width+140,completeDelay:30,onComplete(){globalObjects.reaperDarkFlashTop2.visible=!1}}),PhaserScene.tweens.add({targets:globalObjects.reaperDarkFlashTop2,alpha:1,duration:480,ease:"Cubic.easeIn",scaleX:40});let i=570+s;PhaserScene.tweens.add({delay:10,targets:globalObjects.reaperDarkFlashTop,alpha:1,duration:i,ease:"Quint.easeIn"}),PhaserScene.tweens.add({delay:20,targets:globalObjects.reaperDarkFlashTop,duration:i,ease:"Cubic.easeIn",rotation:.32,x:gameConsts.width+180,completeDelay:100,onComplete(){setFloatingDeathVisible(!0),globalObjects.reaperDarkFlashTop.setAlpha(1),globalObjects.reaperDarkFlashBot.setAlpha(1),PhaserScene.tweens.add({targets:globalObjects.reaperDarkFlashBot,alpha:0,duration:1500,ease:"Cubic.easeOut",onComplete(){globalObjects.reaperDarkFlashBot.visible=!1}}),globalObjects.reaperDarkFlashBot.setRotation(.15),PhaserScene.tweens.add({targets:globalObjects.reaperDarkFlashTop,scaleX:0,alpha:0,duration:500,ease:"Cubic.easeOut",onComplete(){globalObjects.reaperDarkFlashTop2.visible=!1}})}})}else setupReaperArrival(),tweenFloatingDeath(.75,1,1200,"Cubic.easeInOut",()=>{gameVars.deathFlutterDelay=450;let t=PhaserScene.add.sprite(gameConsts.halfWidth,140,"misc","scythe1.png").setDepth(999).setAlpha(0).setScale(.65).setRotation(-1.5);t.play("scytheFlash"),PhaserScene.tweens.add({targets:t,alpha:1,duration:450}),PhaserScene.tweens.add({targets:t,y:75,scaleX:.8,scaleY:.8,rotation:-1.35,ease:"Quart.easeIn",duration:400,onComplete:()=>{e.customBgMusic&&fadeAwaySound(e.customBgMusic,1e3,""),PhaserScene.time.delayedCall(820,()=>{tweenObjectRotationTo(globalObjects.deathLeftHand,-.2,500,"Cubic.easeOut"),tweenObjectRotationTo(globalObjects.deathRightHand,.1,500,"Cubic.easeOut")}),PhaserScene.tweens.add({targets:t,scaleX:.9,scaleY:.9,y:65,ease:"Cubic.easeInOut",duration:900}),PhaserScene.tweens.add({targets:t,rotation:-.5,ease:"Quart.easeOut",duration:900,completeDelay:200,onComplete:()=>{t.play("scytheReap"),PhaserScene.tweens.add({targets:t,rotation:"-=1.5",ease:"Quint.easeIn",duration:50,onComplete:()=>{e.customBgMusic&&e.customBgMusic.stop();let s=getFogSlice(),i=getFogSliceDarken();PhaserScene.tweens.add({targets:i,alpha:.75,ease:"Cubic.easeOut",duration:500});let n=globalObjects.fogSwirl?globalObjects.fogSwirl.alpha:1;if(PhaserScene.tweens.add({targets:globalObjects.fogSwirl,alpha:.25,ease:"Cubic.easeIn",duration:300,onComplete(){PhaserScene.tweens.add({delay:100,targets:globalObjects.fogSwirl,ease:"Cubic.easeInOut",alpha:n,duration:1e3})}}),PhaserScene.tweens.add({delay:50,targets:[s],alpha:1,ease:"Quad.easeOut",duration:200,onComplete(){PhaserScene.tweens.add({delay:200,targets:[s,i],ease:"Quart.easeIn",alpha:0,duration:1400})}}),PhaserScene.tweens.add({delay:50,targets:[s],scaleX:1.08,scaleY:1.08,ease:"Quint.easeOut",duration:300,onComplete(){PhaserScene.tweens.add({targets:[s],scaleX:1.09,scaleY:1.09,duration:1500})}}),PhaserScene.tweens.add({delay:50,targets:s,rotation:-.85,ease:"Quad.easeOut",duration:1500}),e){let o=e.sprite;PhaserScene.tweens.add({targets:o,scaleX:1.2*o.scaleX,scaleY:1.2*o.scaleX,alpha:0,duration:750})}setTimeout(()=>{playSound(globalObjects.reapSound||"death_attack").detune=0,messageBus.publish("reapedEnemyGong"),messageBus.publish("showCircleShadow",.4),globalObjects.reapSound=null,messageBus.publish("tempPause",70,.1)},100);let r=PhaserScene.add.image(gameConsts.halfWidth,gameConsts.halfHeight,"blackPixel").setScale(500).setDepth(980).setAlpha(1);this.scytheBlur||(this.scytheBlur=PhaserScene.add.image(gameConsts.halfWidth,t.y,"blurry","scytheblur.png").setDepth(1002).setBlendMode(Phaser.BlendModes.LIGHTEN)),this.scytheBlur.setAlpha(1).setScale(.82).setRotation(-.15),PhaserScene.tweens.add({targets:[r],alpha:0,duration:1500,ease:"Quad.easeOut",onComplete(){r.destroy()}}),PhaserScene.tweens.add({targets:[this.scytheBlur],alpha:0,ease:"Cubic.easeOut",duration:700}),PhaserScene.tweens.add({targets:t,rotation:-3.5,x:"-=10",ease:"Quint.easeOut",duration:500,onComplete(){repeatDeathHandsRotate(),PhaserScene.tweens.add({delay:200,targets:t,rotation:"+=0.1",x:"-=12",ease:"Quart.easeInOut",duration:2e3}),PhaserScene.tweens.add({targets:t,alpha:0,delay:1e3,scaleX:.6,scaleY:.6,ease:"Cubic.easeIn",duration:600,onComplete(){t.destroy(),e.destroy(),setFloatingDeathDepth(100010),handleReaperDialog(l,()=>{gameVars.deathFlutterDelay=10,repeatDeathFlutterAnimation(-.25),clearReaper(),globalObjects.postFightScreen.startGloom(),PhaserScene.tweens.add({targets:[t],scaleX:.5,scaleY:.5,alpha:0,ease:"Cubic.easeIn",duration:1100,completeDelay:200,onComplete(){PhaserScene.tweens.add({targets:[globalObjects.fogSliceDarken],alpha:0,duration:1e3,onComplete(){globalObjects.fogSliceDarken.destroy()}}),a?a():setTimeout(()=>{globalObjects.magicCircle.enableMovement(),globalObjects.postFightScreen.createWinScreen(l)},200)}})})}})}})}})}})}})})}function playReaperPassiveAnim(e,a,t=!0){let l=e.getLevel();if(t){playSound("whoosh").detune=-500,globalObjects.reaperDarkFlashTop||(globalObjects.reaperDarkFlashBot=PhaserScene.add.image(gameConsts.halfWidth,gameConsts.halfHeight,"blackPixel"),globalObjects.reaperDarkFlashTop=PhaserScene.add.image(-150,gameConsts.halfHeight,"pixels","black_blue_pixel.png").setOrigin(1,.5).setDepth(60),globalObjects.reaperDarkFlashTop2=PhaserScene.add.image(-150,gameConsts.halfHeight,"pixels","black_blue_pixel.png").setOrigin(1,.5).setDepth(60),globalObjects.reaperDarkFlashTop3=PhaserScene.add.image(-150,gameConsts.halfHeight,"pixels","black_blue_pixel.png").setOrigin(1,.5).setDepth(60)),globalObjects.reaperDarkFlashBot.setScale(700).setAlpha(0).setVisible(!0),globalObjects.reaperDarkFlashTop.setScale(500,750).setRotation(.38).setPosition(-160,gameConsts.halfHeight).setAlpha(.05).setVisible(!0),globalObjects.reaperDarkFlashTop2.setScale(50+80*Math.random(),700).setRotation(.3).setPosition(-140,gameConsts.halfHeight).setAlpha(.65).setVisible(!0),globalObjects.reaperDarkFlashTop3.setScale(500,750).setRotation(.26).setPosition(-120,gameConsts.halfHeight).setAlpha(.3).setVisible(!0);let s=Math.floor(50*Math.random());PhaserScene.tweens.add({targets:globalObjects.reaperDarkFlashTop,scaleY:750,duration:500+s,onComplete(){setupReaperArrival(),setFloatingDeathDepth(100010),tweenFloatingDeath(.75,1,1250,"Cubic.easeInOut",()=>{gameVars.deathFlutterDelay=450,repeatDeathHandsRotate(),setFloatingDeathDepth(100010),repeatDeathFlutterAnimation(-.25),handleReaperDialog(l,()=>{gameVars.deathFlutterDelay=10,clearReaper(),PhaserScene.tweens.add({targets:[globalObjects.fogSliceDarken],alpha:0,duration:1e3,onComplete(){globalObjects.fogSliceDarken.destroy()}}),a&&a()})}),globalObjects.reaperDarkFlashTop2.visible&&setFloatingDeathVisible(!1)}}),PhaserScene.tweens.add({targets:globalObjects.reaperDarkFlashTop3,duration:320+Math.floor(30*Math.random()),rotation:.12,ease:"Quad.easeIn",x:gameConsts.width+160,onComplete(){globalObjects.reaperDarkFlashTop3.visible=!1}}),PhaserScene.tweens.add({targets:globalObjects.reaperDarkFlashTop3,alpha:1,duration:450,ease:"Cubic.easeIn"}),PhaserScene.tweens.add({delay:10,targets:globalObjects.reaperDarkFlashTop2,alpha:1,duration:465+30*Math.random(),ease:"Quad.easeIn",rotation:.23,x:gameConsts.width+140,completeDelay:30,onComplete(){globalObjects.reaperDarkFlashTop2.visible=!1}}),PhaserScene.tweens.add({targets:globalObjects.reaperDarkFlashTop2,alpha:1,duration:480,ease:"Cubic.easeIn",scaleX:40});let i=570+s;PhaserScene.tweens.add({delay:10,targets:globalObjects.reaperDarkFlashTop,alpha:1,duration:i,ease:"Quint.easeIn"}),PhaserScene.tweens.add({delay:20,targets:globalObjects.reaperDarkFlashTop,duration:i,ease:"Cubic.easeIn",rotation:.32,x:gameConsts.width+180,completeDelay:100,onComplete(){setFloatingDeathVisible(!0),globalObjects.reaperDarkFlashTop.setAlpha(1),globalObjects.reaperDarkFlashBot.setAlpha(1),PhaserScene.tweens.add({targets:globalObjects.reaperDarkFlashBot,alpha:0,duration:1500,ease:"Cubic.easeOut",onComplete(){globalObjects.reaperDarkFlashBot.visible=!1}}),globalObjects.reaperDarkFlashBot.setRotation(.15),PhaserScene.tweens.add({targets:globalObjects.reaperDarkFlashTop,scaleX:0,alpha:0,duration:500,ease:"Cubic.easeOut",onComplete(){globalObjects.reaperDarkFlashTop2.visible=!1}})}})}else setupReaperArrival(),setFloatingDeathDepth(100010),tweenFloatingDeath(.75,1,1200,"Cubic.easeInOut",()=>{gameVars.deathFlutterDelay=450,repeatDeathHandsRotate(),setFloatingDeathDepth(100010),repeatDeathFlutterAnimation(-.25),handleReaperDialog(l,()=>{gameVars.deathFlutterDelay=10,clearReaper(),PhaserScene.tweens.add({targets:[globalObjects.fogSliceDarken],alpha:0,duration:1e3,onComplete(){globalObjects.fogSliceDarken.destroy()}}),a&&a()})})}function setupReaperArrival(){if(playSound("sound_of_death"),messageBus.publish("reapedEnemyGong"),globalObjects.magicCircle.disableMovement(),getFloatingDeath(),showHandsTemp(),globalObjects.fogSwirl){globalObjects.fogSwirl.currAnim.stop(),globalObjects.fogSwirl.currAnimScale.stop(),globalObjects.fogSwirl.currAnim=PhaserScene.tweens.add({targets:[globalObjects.fogSwirl,globalObjects.fogSwirlGlow],scaleX:1.15,scaleY:1.15,alpha:.9,ease:"Cubic.easeInOut",rotation:"+=1.5",duration:1600});let e=PhaserScene.tweens.add({delay:1400,targets:[globalObjects.fogSwirl,globalObjects.fogSwirlGlow],rotation:"+=6.283",duration:45e3,repeat:-1,onStart(){PhaserScene.tweens.add({targets:[globalObjects.fogSwirl,globalObjects.fogSwirlGlow],scaleX:1.17,scaleY:1.17,alpha:.92,ease:"Quad.easeOut",duration:1e3}),globalObjects.fogSwirl.currAnim.stop(),globalObjects.fogSwirl.currAnim=e}})}startDeathFlutterAnim(),globalObjects.floatingDeath.fakeAlpha=globalObjects.floatingDeath.alpha,globalObjects.floatingDeath2.fakeAlpha=globalObjects.floatingDeath.alpha,globalObjects.deathLeftHand.setRotation(-.55),globalObjects.deathRightHand.setRotation(.45),tweenObjectRotationTo(globalObjects.deathLeftHand,.2,2400,"Cubic.easeInOut"),tweenObjectRotationTo(globalObjects.deathRightHand,-.1,2400,"Cubic.easeInOut")}function clearReaper(){globalObjects.deathLeftHand.currAnim&&(globalObjects.deathLeftHand.currAnim.stop(),globalObjects.deathRightHand.currAnim.stop()),globalObjects.floatingDeath.visible=!0,globalObjects.floatingDeath2.visible=!0,tweenObjectRotationTo(globalObjects.deathLeftHand,-.38,1100,"Cubic.easeIn"),tweenObjectRotationTo(globalObjects.deathRightHand,.32,1100,"Cubic.easeIn"),globalObjects.deathLeftHand.alpha=3,globalObjects.deathRightHand.alpha=3,tweenFloatingDeath(.5,.1,1100,"Quad.easeIn",()=>{globalObjects.floatingDeath.flutterAnim.stop(),globalObjects.floatingDeath.visible=!0,globalObjects.floatingDeath2.visible=!1,globalObjects.floatingDeath.alpha=.1,PhaserScene.tweens.add({targets:[globalObjects.floatingDeath,globalObjects.deathLeftHand,globalObjects.deathRightHand],alpha:0,fakeAlpha:0,scaleX:.3,scaleY:.3,duration:400,ease:"Quad.easeOut",onComplete(){globalObjects.floatingDeath.visible=!1,globalObjects.deathLeftHand.visible=!0,globalObjects.deathRightHand.visible=!0,globalObjects.floatingDeath.setFrame("max_death_1a.png"),globalObjects.floatingDeath2.setFrame("max_death_1b.png")}})})}function stopDeathFlutterAnim(){globalObjects.floatingDeath.flutterAnim&&globalObjects.floatingDeath.flutterAnim.stop()}function startDeathFlutterAnim(e){globalObjects.floatingDeath2.setVisible(!0).setScale(globalObjects.floatingDeath.scaleX).setDepth(globalObjects.floatingDeath.depth),gameVars.deathFlutterDelay=0,repeatDeathFlutterAnimation(e)}function repeatDeathFlutterAnimation(e=0){stopDeathFlutterAnim(),globalObjects.floatingDeath2.alpha=0,globalObjects.floatingDeath.alpha=1,globalObjects.floatingDeath.flutterAnim=PhaserScene.tweens.add({targets:globalObjects.floatingDeath2,alpha:globalObjects.floatingDeath2.fakeAlpha+e,duration:70+gameVars.deathFlutterDelay,ease:"Cubic.easeIn",onComplete(){globalObjects.floatingDeath.flutterAnim=PhaserScene.tweens.add({targets:globalObjects.floatingDeath,alpha:0,duration:20+gameVars.deathFlutterDelay,ease:"Cubic.easeOut",completeDelay:100+2*gameVars.deathFlutterDelay,onComplete(){globalObjects.floatingDeath2.setDepth(globalObjects.floatingDeath.depth-1),globalObjects.floatingDeath.flutterAnim=PhaserScene.tweens.add({targets:globalObjects.floatingDeath,alpha:globalObjects.floatingDeath.fakeAlpha+e,duration:70+gameVars.deathFlutterDelay,ease:"Cubic.easeIn",onComplete(){globalObjects.floatingDeath.flutterAnim=PhaserScene.tweens.add({targets:globalObjects.floatingDeath2,alpha:0,duration:20+gameVars.deathFlutterDelay,ease:"Cubic.easeOut",completeDelay:100+2*gameVars.deathFlutterDelay,onComplete(){globalObjects.floatingDeath2.setDepth(globalObjects.floatingDeath.depth+1),repeatDeathFlutterAnimation()}})}})}})}})}function handleReaperDialog(e=0,a){let t=[],l=[];switch(e){case 1:a&&a();case 2:t=[getLangText("death2a"),getLangText("death2b"),getLangText("death2c"),];break;case 3:t=[getLangText("death3a"),getLangText("death3b"),getLangText("death3c"),];break;case 4:t=[getLangText("death4b"),getLangText("death4c"),getLangText("death4d"),];break;case 5:t=[getLangText("death_statue1"),getLangText("death_statue2"),getLangText("death_statue3"),],l=[null,null,()=>{messageBus.publish("lift_statue")}];break;case 6:t=[getLangText("death5demoa"),getLangText("death5demob"),getLangText("death5democ"),getLangText("death5demod"),];break;case 7:t=[getLangText("death6a"),getLangText("death6b"),],l=[()=>{stopDeathFlutterAnim(),tweenFloatingDeath(.75,0,400,"Quad.easeOut",()=>{hideHandsTemp(),globalObjects.floatingDeath.visible=!0,globalObjects.floatingDeath2.visible=!0,globalObjects.deathLeftHand.visible=!1,globalObjects.deathRightHand.visible=!1,globalObjects.floatingDeath.alpha=.15,globalObjects.floatingDeath2.alpha=.15,globalObjects.floatingDeath.setFrame("max_death_1a_angry.png"),globalObjects.floatingDeath2.setFrame("max_death_1b_angry.png"),globalObjects.floatingDeath.fakeAlpha=1,globalObjects.floatingDeath2.fakeAlpha=1,gameVars.deathFlutterDelay=350,repeatDeathFlutterAnimation(0)})},void 0];break;case 8:t=[getLangText("death7a"),getLangText("death7b"),getLangText("death7c"),getLangText("death7d"),getLangText("death7e"),getLangText("death7f"),],l=[()=>{globalObjects.bannerTextManager.speedUpText()},()=>{playSound("slice_in",.4),playSound("enemy_attack",.68);let e=getBackgroundBlackout();e.setDepth(100).setAlpha(.5).setVisible(!0),screenShakeLong(2),PhaserScene.tweens.add({targets:e,alpha:0,duration:3e3,ease:"Quart.easeOut"}),globalObjects.bannerTextManager.setPosition(gameConsts.halfWidth,gameConsts.height-130)},()=>{playSound("enemy_attack_2",.68)},()=>{let e=getBackgroundBlackout();e.setDepth(100).setAlpha(.4).setVisible(!0),PhaserScene.tweens.add({targets:e,alpha:0,duration:4e3}),globalObjects.bannerTextManager.setPosition(gameConsts.halfWidth,gameConsts.halfHeight+10)},];break;case 9:t=[getLangText("death8a"),getLangText("death8b"),];break;default:a&&a();return}playReaperDialog(t,l,a)}function playReaperDialog(e,a,t){globalObjects.bannerTextManager.setDialog(e),globalObjects.bannerTextManager.setDialogFunc(a);let l=getFogSliceDarken();PhaserScene.tweens.add({targets:l,alpha:.5,ease:"Cubic.easeOut",duration:500}),globalObjects.bannerTextManager.showBanner(),globalObjects.bannerTextManager.setPosition(gameConsts.halfWidth,gameConsts.halfHeight),globalObjects.bannerTextManager.setOnFinishFunc(t,100)}
